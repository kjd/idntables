Note: This code does not currently track to the recent versions of the specification.
